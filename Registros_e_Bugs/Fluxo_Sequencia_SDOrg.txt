title Fluxo de Sequência: Headers Modulares e Timeouts

participant Usuário (Browser)
participant Pod Frontend (Auth/Home)
participant Library (app-library-logs)
participant Gateway (Nginx/API)
participant Backend (.NET)
participant Redis

Usuário (Browser)->>Pod Frontend (Auth/Home): Aciona Requisição HTTP
Pod Frontend (Auth/Home)->>Library (app-library-logs): Intercepta via TimeoutInterceptor
note right of Library (app-library-logs): Inicia timer de 30s
Library (app-library-logs)->>Library (app-library-logs): Intercepta via ModuleHeaderInterceptor
note right of Library (app-library-logs): Lê LOG_CONFIG do Pod
Library (app-library-logs)->>Library (app-library-logs): Injeta SIGLA-APLICACAO-MODULO
Library (app-library-logs)->>Library (app-library-logs): Injeta MESSAGE-ID-MODULO
Library (app-library-logs)->>Library (app-library-logs): Injeta SESSAO-ID & HARDWARE-ID
Library (app-library-logs)->>Gateway (Nginx/API): Envia Requisição com Headers
Gateway (Nginx/API)->>Gateway (Nginx/API): Valida Mandatory Headers
Gateway (Nginx/API)->>Backend (.NET): Encaminha para o Microserviço
alt É Fluxo de Login
    Backend (.NET)->>Redis: Persiste Assinatura (SessionId + HardwareId)
    Redis-->>Backend (.NET): Ok
end
Backend (.NET)-->>Gateway (Nginx/API): Retorna Resposta
Gateway (Nginx/API)-->>Pod Frontend (Auth/Home): Retorna Resposta
Pod Frontend (Auth/Home)->>Library (app-library-logs): Finaliza Timer de Timeout
Pod Frontend (Auth/Home)-->>Usuário (Browser): Exibe Dados ao Usuário

note over Usuário (Browser), Backend (.NET): Se demorar > 30s, o TimeoutInterceptor cancela a Task
#Site: https://www.websequencediagrams.com/